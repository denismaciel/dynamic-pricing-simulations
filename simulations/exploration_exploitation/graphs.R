library(tidyverse)

df <- list.files('simulations/exploration_exploitation/data', pattern = '*.csv', full.names = TRUE) %>%
  map(
    function(x) read_csv(x) %>%
        mutate(experiment = fs::path_file(x) %>% stringr::str_remove(".csv"))
  ) %>%
  bind_rows


df %>% 
  group_by(experiment, period_id) %>% 
  summarise(avg_revenue = mean(revenue)) %>% 
  ggplot(aes(period_id, avg_revenue, color = experiment)) +
  geom_line() 
  # facet_grid(experiment ~ .)

# How often each price was picked in every period
df %>% 
  count(experiment, period_id, price) %>%
  group_by(experiment, period_id) %>% 
  mutate(pp_chosen = n / sum(n)) %>% 
  ggplot(aes(period_id, pp_chosen, color = factor(price))) +
  geom_line() +
  facet_grid(experiment ~ .)
  
